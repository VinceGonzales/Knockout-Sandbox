USE [XolartekDb]

DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Xolartek.ORM.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201808231646247_AutomaticMigration'
BEGIN
    CREATE TABLE [dbo].[MaterialCosts] (
        [Id] [int] NOT NULL IDENTITY,
        [Cost] [int] NOT NULL,
        [MaterialId] [int] NOT NULL,
        [SchematicId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.MaterialCosts] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Traits] (
        [Id] [int] NOT NULL IDENTITY,
        [Description] [nvarchar](max) NOT NULL,
        CONSTRAINT [PK_dbo.Traits] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Pictures] (
        [Id] [int] NOT NULL IDENTITY,
        [Source] [nvarchar](max) NOT NULL,
        [CSSClass] [nvarchar](max),
        [Alternate] [nvarchar](max),
        CONSTRAINT [PK_dbo.Pictures] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[TraitImpacts] (
        [Id] [int] NOT NULL IDENTITY,
        [Impact] [nvarchar](max) NOT NULL,
        [WeaponClass] [int] NOT NULL,
        [TraitId] [int] NOT NULL,
        [SchematicId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.TraitImpacts] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Schematics] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](100),
        [Description] [nvarchar](max),
        [Durability] [int] NOT NULL,
        [Level] [int] NOT NULL,
        [Stars] [int] NOT NULL,
        [Damage] [int] NOT NULL,
        [CritChance] [decimal](18, 2) NOT NULL,
        [CritDamage] [decimal](18, 2) NOT NULL,
        [AttackRate] [decimal](18, 2) NOT NULL,
        [DurabilityPerUse] [decimal](18, 2) NOT NULL,
        [Impact] [int] NOT NULL,
        [ReloadTime] [decimal](18, 2) NOT NULL,
        [MagazineSize] [int] NOT NULL,
        [Range] [int] NOT NULL,
        [AmmoCost] [int] NOT NULL,
        [RarityId] [int] NOT NULL,
        [PictureId] [int],
        [WeaponEditionId] [int],
        [WeaponTypeId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.Schematics] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Materials] (
        [Id] [int] NOT NULL,
        [PictureId] [int],
        CONSTRAINT [PK_dbo.Materials] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Rarities] (
        [Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.Rarities] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[WeaponEditions] (
        [Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.WeaponEditions] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[WeaponTypes] (
        [Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.WeaponTypes] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_MaterialId] ON [dbo].[MaterialCosts]([MaterialId])
    CREATE INDEX [IX_SchematicId] ON [dbo].[MaterialCosts]([SchematicId])
    CREATE INDEX [IX_TraitId] ON [dbo].[TraitImpacts]([TraitId])
    CREATE INDEX [IX_SchematicId] ON [dbo].[TraitImpacts]([SchematicId])
    CREATE INDEX [IX_RarityId] ON [dbo].[Schematics]([RarityId])
    CREATE INDEX [IX_PictureId] ON [dbo].[Schematics]([PictureId])
    CREATE INDEX [IX_WeaponEditionId] ON [dbo].[Schematics]([WeaponEditionId])
    CREATE INDEX [IX_WeaponTypeId] ON [dbo].[Schematics]([WeaponTypeId])
    CREATE INDEX [IX_Id] ON [dbo].[Materials]([Id])
    CREATE INDEX [IX_PictureId] ON [dbo].[Materials]([PictureId])
    CREATE INDEX [IX_Id] ON [dbo].[Rarities]([Id])
    CREATE INDEX [IX_Id] ON [dbo].[WeaponEditions]([Id])
    CREATE INDEX [IX_Id] ON [dbo].[WeaponTypes]([Id])
    ALTER TABLE [dbo].[MaterialCosts] ADD CONSTRAINT [FK_dbo.MaterialCosts_dbo.Materials_MaterialId] FOREIGN KEY ([MaterialId]) REFERENCES [dbo].[Materials] ([Id])
    ALTER TABLE [dbo].[MaterialCosts] ADD CONSTRAINT [FK_dbo.MaterialCosts_dbo.Schematics_SchematicId] FOREIGN KEY ([SchematicId]) REFERENCES [dbo].[Schematics] ([Id])
    ALTER TABLE [dbo].[TraitImpacts] ADD CONSTRAINT [FK_dbo.TraitImpacts_dbo.Schematics_SchematicId] FOREIGN KEY ([SchematicId]) REFERENCES [dbo].[Schematics] ([Id])
    ALTER TABLE [dbo].[TraitImpacts] ADD CONSTRAINT [FK_dbo.TraitImpacts_dbo.Traits_TraitId] FOREIGN KEY ([TraitId]) REFERENCES [dbo].[Traits] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.Pictures_PictureId] FOREIGN KEY ([PictureId]) REFERENCES [dbo].[Pictures] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.Rarities_RarityId] FOREIGN KEY ([RarityId]) REFERENCES [dbo].[Rarities] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.WeaponEditions_WeaponEditionId] FOREIGN KEY ([WeaponEditionId]) REFERENCES [dbo].[WeaponEditions] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.WeaponTypes_WeaponTypeId] FOREIGN KEY ([WeaponTypeId]) REFERENCES [dbo].[WeaponTypes] ([Id])
    ALTER TABLE [dbo].[Materials] ADD CONSTRAINT [FK_dbo.Materials_dbo.Traits_Id] FOREIGN KEY ([Id]) REFERENCES [dbo].[Traits] ([Id])
    ALTER TABLE [dbo].[Materials] ADD CONSTRAINT [FK_dbo.Materials_dbo.Pictures_PictureId] FOREIGN KEY ([PictureId]) REFERENCES [dbo].[Pictures] ([Id])
    ALTER TABLE [dbo].[Rarities] ADD CONSTRAINT [FK_dbo.Rarities_dbo.Traits_Id] FOREIGN KEY ([Id]) REFERENCES [dbo].[Traits] ([Id])
    ALTER TABLE [dbo].[WeaponEditions] ADD CONSTRAINT [FK_dbo.WeaponEditions_dbo.Traits_Id] FOREIGN KEY ([Id]) REFERENCES [dbo].[Traits] ([Id])
    ALTER TABLE [dbo].[WeaponTypes] ADD CONSTRAINT [FK_dbo.WeaponTypes_dbo.Traits_Id] FOREIGN KEY ([Id]) REFERENCES [dbo].[Traits] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201808231646247_AutomaticMigration', N'Xolartek.ORM.Migrations.Configuration',  0x1F8B0800000000000400ED5D5B4F24B9157E8F94FF50AAA7DD88A561E665839A5DB10D13A10C03A261B36FC85499A63475E954B9116CB4BF2C0FF949F90B71DD7D2FDB75E96E321A0941957DCEF1F1E7CB39657FF3DF7FFF67FEF36B143A2F30CD82243E758F0F8F5C07C65EE207F1EAD4DDA0A71F7E747FFEE9CF7F9A5FF8D1ABF36B5DEE635E0ED78CB353F719A1F5C96C9679CF3002D96114786992254FE8D04BA219F093D987A3A3BFCE8E8F67108B70B12CC799DF6E621444B0F803FFB948620FAED1068457890FC3AC7A8EDF2C0BA9CE1710C16C0D3C78EAFE96842045F0EBE1F5ED95EB9C8501C0362C61F8E43A208E130410B6F0E43E834B9426F16AB9C60F4078F7B686B8DC13083358597ED216D76DC4D187BC11B3B6622DCADB6428890C051E7FACBC3263AB5BF9D66DBC86FD7681FD8BDEF25617BE3B75AF00822976C422C990EBB00A4F16619A1726DCBB485278F82949511C207848563F70A842070D2C307AF27F07CE6213A24D0A4F63B84129080F9C9BCD6318787F876F77C957189FC69B3024CDC506E377D403FCE8264DD630456FB7F0A96AC4A5EF3A33BADE8CADD85423EA944DBB8CD1C70FAEF3052B078F216CD040B861897083FE066398E2F6FA3700E156C7B90C58F893D3CEE82A9DABD6A69650FBB9DB6AB59C72DCA0C03316F405BC04ABC21B12D35CE716864581EC39589763AFC1C7030994CC753EA549749B844475BAC4C31D485730775AA22CB64C36A967606CD37EA1B5CDDB460B65AAE03567A7A88CC8C8F9AC1D8A5A03B4C7E01C68603ABF800C960A0B6FDDA52040AE126E378197CBE5C0668AAD0A354302ACEE940E80D5FDAB6B71D562B5AD4D218195D53BB97D75019165DAA86A2CD0055555E1DB1C2F9D59EBFE2A07084AF14EC975AEC0EB6718AFD073DE81AFB8C38357E8D74F2A1BEEE3006FAC7025946EA0F18CBE582E1721C8B20134AB159D85B943B06F06D6A48DD962BEB98CF076CF66A742D4FE0662A9AECABB5383F81F10AC9398C2B1DDFEA6ECE5DDDB24E9EE3B0AFB259B8EF29D62C7511530DD1395EBB8C8AEE2CD03317228CBF8B79C6D8222BD3643841B8D2780A6EEB7E12FD395FF540CFEE3A3A301D69173987969B02EE3D991D7ACF34D0A1E83B0687A9F19E1337C8161CF490581B4E7E4760E22B082FD642CD2002D9E41DC6E55CEA11744797C7193E2DFAA7CCF8FAEB3F4402ED54E056DEAE02ACE1002DED75B623332B88A163A3730BDCFC65344AFB976BD8AE7EE04F87741349E995760057E0F62B80C7EEF09C15B10F745F1591425FD932AB70023F5ADEF6E4133C615EE782EFC209F07ADEAE61586CFE288A36C8BC4081BBFAA92274304D7AD7C4174CDBD5498A78AAF55C6956812DA56BE7A687450CEE35E72BB28BE84D516AFAB6B35F69E72AF319B535DC3A86120B48F2A2171A1AC0CE74969415387B643506174FE5A69315340622E5BAAD70EBA46A9F1F6B9AC38612AB13B961203DA70B0B190960F472B7F330037763B557F0FBCDF6BB8B27DD139AE7B744939762DFB232FB2379D613C0D89BB413659D9E7F26CB378DF027899AE61636BEBCD249D311A22B1C44252917BD2C1E35996255E5058C5EC7F99EF4874832F62DFD1FBA8D48EE7F6FBDD150665B0C630C406E1608C7367A7F4667BC04B2F83215AC35F380D18C830CD91945788333C348218F1A80F622F588350ABA94C6DCD5193F74CA3877D730ED730CE01AFE50D1D03C8AFE7BC218D3E666077796B3E2360A489AE3A36E9EC792E4EE94614DFDF0AB9022C3571132DF6E8F090C76A3F2431464C8921C6AF3AAA89007F2BE01105DFB27E5646E26D57137974FD594979FC61D22949D1CA09B0A4F0838E76EAEBD29601D5351D29F2261A60524D48F27CCB943392D48A4961B48773121F64CB3A5A1171B71D5D6725F4272345D6CC0A9956F091B66D02F8481DA0A3BBCD7C6F7902AA728EDDB3049B801C6C2D63BFAA339178FD7566E4758C6EDEA4B30FED80FD58C1A45926597F77A79CDA7E6752761A6B8F869E2DCC4E5D6D9E00655DEED03181FB52B645C4B1A934350CA47935166B652E527FF6EAF87A3035C424ED9C0C5F1247E883ABFE94BA1564097261B27E5725C6D80CB2019C5407B9A65C0EE5CD9B004A7227E8286FCE1D4E00A132A589EB205C03A69505454AFC1C20F00832D1878DFB0C56C9F5ACCAEFB270C8A52E21121FBD6FF3A8C2309FC3162DAC0A5744729A18AF43049D2CE6C450E8EC10457E0BE1041153A68E45525BB8EA446FF25E66AF2F1085D5171D58B869A7A89BD6B40DE1B0AB9D912684310D61BF96D05E30F1500314856F84F90CBD04ABA53FD8EC0521A6057D6F2708CFDFF07EE8CC146AE70A896690A345E1115576704478088EFDA8FCD20D1079CAAB8F4FA68189E0E803EF8C8ED48D66F2C66CB8C8B3355A4EED858BDA3C152C446908BD44441F5030A907D6A5CD62D7DB19F24319BC53F4426BB3E0DA0C2C9D31F45898911C9790F948190C1A848336DE91C57E63B946F4C19EF74B5728A31BCC98794411BEF41F52F5098266BBDDBC9BCF4A0F570FE633095BC1FC0AACD741BC22D80BAA27CEB2A42E58FCB034BFD91F95326634F0D8E0A0D1849214AC20F336BF99EEC34F419AA1367258F811578C0E2E24DBE25A97287EE07BAFDE33D7B5F2DF8948A66272A0C30C3E12AB6A7FC28D8BF258AE383F23D96EF0D59D9C4802606D82233B8B24DC44B13CB494D72E2322B2BE2846524920CF2B907254E718E4D2A8742D294E99C7CD11CD78970B6DB95E6446150B0D2DE048D76243C4F4400BA77D2CA8109FF148218AAF7BFDBBC5C497D57739734F16150338B823A76C3CFD1DC0DC0754FD77E089224B6DEB8622F1B4673EB8CCF2DFAF9FBEA39C51CC4FDF5B384270B2B7BF0B64B5A993A0A418EAC5CE4CFA4D106C8D514964AFD12FD29AE3F44CBDC9A55662E1F513959496F681DA68344FF52511BC0EA428E2F1CEA0A423B2D0440A992AB61CC5B2DAE320A64E6B531284A96E95148A63811445BDD097D77CF2206549BF83C8E5ECD9F65419F06B22B0FDC6608E3F45DD71D097FFA4EB974FC65F8BA4F2885BFD9438E2B9BEB4EA6E3F29A87A6480E1F2723F85DEF29141ABAA2BF3548BAA6706EB0271BF9F5A1988E766D2447691CF0D561AE2D63EB5D410CF6D50505FD01763A17E3BF57C4BDEC9272591CF4D5202E4F57B3A2940BE31B0AFBC864F99563E32E8D1E61E3ED59FCD53136BEA1389B441B2738A72493631B57ACD24CE1EF1EBA6E2605297DCFAD8092F54762065E4558F4B76B2451AED4DD293496ECEAB4463375F2B97792C8BE48415C94BE0E759C7E55B8660749817385CFE335C84016E6F5BE00AC4C113CC5079A5CFFD7074FC81217EDD1D12D65996F9A120514B5C8994A72AA7B89B18E49EEDBC7D68CA04435074140A7AB39E1652B8B32D97B10F5F4FDD7F15D54E9CCBDF1EDA9A07CE758AC172E21C397F0CC104A66B0151D5C084DE17681B43FE782718125C698D5F40EA3D83F4BB08BC7E3F9443C55761F6D56BF4B1401387094631C330299566C5226920CD8A29F27DF4274D12D5AF3F05648B36933343B5A83B2F56D5DEE9B4AC22287C7753739907A021C913069ACD0F26D3BD1D03A00DD629FE3F1B0114FB9F8D009A50CF4602CFFCE78FCFFC37B80A9EF96F701532E6BFC115D193BA4D9FF2BC7F831B29E2FDB3329564FDB311C072FED9194133FEE9AE1A75BD5EAB164714A8ABBDA92853AF33114A0807756D60AAF7B7A44E71D89851D61D63FD96312C4CB5446BB8608F5068C64AC71D17D95BAFDBB1C3FD9FB65E7032E4DD357D30BEA9F6BF7920EFBD6436E452E45A3A359794E024D0789C3F92A3A33B481365C5F4D39F0C619B88507D0ADF3E22B6CF74A0CFD5D3DC7FB224D0B186D64048901FE01A8FFCE23D72EDE4DB288E5BA77868418F323D9D8EF0D0F0B621B0777C39FD1705EA42F576587126BBF62F3D0CB88B2B423FEE1B7A6E605FEDC132D175AA7EDB53C57ED3D588E0513DDFF5D54379CF603750B1573C330370CA6C65F9905CB3D8FED23125478C22E19077462BEC21A7DD7EA8B09168C49D0360C33099311CDDE764D01822CFB14BB4D4C3C596867DBF7FB1A559D7EF486CA99C1324C9F941A704A3C8750F27840142DBC9430B2528945F2E0685C6B0E1CB6EC364B0E066DA10430329A2AF3C23C0C42886D95B80F40D7226A224E4C945D8CE93530E76320E96F1D7A9EB3F26B8BFCB2F726A7231565D05314E4FF55CA440CC4623A33B54B11D8AA44B99C08496D74194D8FEFAADB415322A1C561711B6739A8877223D0A062259D7AB98263375A7772B69F7139C8EF6954845FBB64303BB20717AD802226D6C192D9DD504275158BD956BAB0A30AAB6455999092903F51819C9C983A700E20E0CEC1815A398C16BC71A3E10D322334B525C0CAA061B3A6B677814899987E6C8D96E63C7624AB480B2605DE33817FA37784A3644BAC7D533FBC4FD3E01DBA1A8F5C29566E2A68FC566C8837607E06E9AF8552DE436B9E3DE6E32DC156C9F63DA76611BBFA146E93EF99A67912EEC8D02A325B4F7AA6092FBEA5C36AC1369BD9D66BD16F55B4FB4F341EAD5C62EAD3490D38CD6AF61086479EE84F9EC76836B47E561E2F939CC82552B628E65C6D0A392314D99CBF829A9F3418C457511F6A60F44C007089CA52878C26B0F7EEDC12C2BFEF7E05F41B8C1452EA247E85FC6D71BB4DE20DC64183D8614D94E9E5B52E92F5872699BE7D7C56DBF6C8826603303DC04781DFFB20942BFB1FB93E0A8B644449EB4AAEE48E67D89F2BB92ABB746D29724D61454B9AFC9B5DDC1681D6261D975BC042FD0C6B6FB0C7E862BE0BDD514187221DD1D41BB7D7E1E80550AA2AC92D1D6C77F620CFBD1EB4FFF03C097AF67189A0000 , N'6.2.0-61023')
END
