USE [XolartekDb]

DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Xolartek.ORM.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201808241555047_AutomaticMigration'
BEGIN
    CREATE TABLE [dbo].[Heroes] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](100) NOT NULL,
        [Stars] [int] NOT NULL,
        [Level] [int] NOT NULL,
        [Description] [nvarchar](max),
        [RarityId] [int] NOT NULL,
        [PictureId] [int],
        [DateCreated] [datetime] NOT NULL,
        [TimeStamp] rowversion NOT NULL,
        CONSTRAINT [PK_dbo.Heroes] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Pictures] (
        [Id] [int] NOT NULL IDENTITY,
        [Source] [nvarchar](max) NOT NULL,
        [CSSClass] [nvarchar](max),
        [Alternate] [nvarchar](max),
        CONSTRAINT [PK_dbo.Pictures] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Rarities] (
        [Id] [int] NOT NULL IDENTITY,
        [Description] [nvarchar](max) NOT NULL,
        CONSTRAINT [PK_dbo.Rarities] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Schematics] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](100),
        [Description] [nvarchar](max),
        [Durability] [int] NOT NULL,
        [Level] [int] NOT NULL,
        [Stars] [int] NOT NULL,
        [Damage] [int] NOT NULL,
        [CritChance] [decimal](18, 2) NOT NULL,
        [CritDamage] [decimal](18, 2) NOT NULL,
        [AttackRate] [decimal](18, 2) NOT NULL,
        [DurabilityPerUse] [decimal](18, 2) NOT NULL,
        [Impact] [int] NOT NULL,
        [ReloadTime] [decimal](18, 2) NOT NULL,
        [MagazineSize] [int] NOT NULL,
        [Range] [int] NOT NULL,
        [AmmoCost] [int] NOT NULL,
        [RarityId] [int] NOT NULL,
        [PictureId] [int],
        [WeaponEditionId] [int],
        [WeaponTypeId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.Schematics] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[MaterialCosts] (
        [Id] [int] NOT NULL IDENTITY,
        [Cost] [int] NOT NULL,
        [MaterialId] [int] NOT NULL,
        [SchematicId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.MaterialCosts] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Materials] (
        [Id] [int] NOT NULL IDENTITY,
        [Description] [nvarchar](max) NOT NULL,
        [PictureId] [int],
        CONSTRAINT [PK_dbo.Materials] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[TraitImpacts] (
        [Id] [int] NOT NULL IDENTITY,
        [Impact] [nvarchar](max) NOT NULL,
        [WeaponClass] [int] NOT NULL,
        [TraitId] [int] NOT NULL,
        [SchematicId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.TraitImpacts] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Traits] (
        [Id] [int] NOT NULL IDENTITY,
        [Description] [nvarchar](max) NOT NULL,
        CONSTRAINT [PK_dbo.Traits] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[WeaponEditions] (
        [Id] [int] NOT NULL IDENTITY,
        [Description] [nvarchar](max) NOT NULL,
        CONSTRAINT [PK_dbo.WeaponEditions] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[WeaponTypes] (
        [Id] [int] NOT NULL IDENTITY,
        [Description] [nvarchar](max) NOT NULL,
        CONSTRAINT [PK_dbo.WeaponTypes] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_RarityId] ON [dbo].[Heroes]([RarityId])
    CREATE INDEX [IX_PictureId] ON [dbo].[Heroes]([PictureId])
    CREATE INDEX [IX_RarityId] ON [dbo].[Schematics]([RarityId])
    CREATE INDEX [IX_PictureId] ON [dbo].[Schematics]([PictureId])
    CREATE INDEX [IX_WeaponEditionId] ON [dbo].[Schematics]([WeaponEditionId])
    CREATE INDEX [IX_WeaponTypeId] ON [dbo].[Schematics]([WeaponTypeId])
    CREATE INDEX [IX_MaterialId] ON [dbo].[MaterialCosts]([MaterialId])
    CREATE INDEX [IX_SchematicId] ON [dbo].[MaterialCosts]([SchematicId])
    CREATE INDEX [IX_PictureId] ON [dbo].[Materials]([PictureId])
    CREATE INDEX [IX_TraitId] ON [dbo].[TraitImpacts]([TraitId])
    CREATE INDEX [IX_SchematicId] ON [dbo].[TraitImpacts]([SchematicId])
    ALTER TABLE [dbo].[Heroes] ADD CONSTRAINT [FK_dbo.Heroes_dbo.Pictures_PictureId] FOREIGN KEY ([PictureId]) REFERENCES [dbo].[Pictures] ([Id])
    ALTER TABLE [dbo].[Heroes] ADD CONSTRAINT [FK_dbo.Heroes_dbo.Rarities_RarityId] FOREIGN KEY ([RarityId]) REFERENCES [dbo].[Rarities] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.Pictures_PictureId] FOREIGN KEY ([PictureId]) REFERENCES [dbo].[Pictures] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.WeaponEditions_WeaponEditionId] FOREIGN KEY ([WeaponEditionId]) REFERENCES [dbo].[WeaponEditions] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.WeaponTypes_WeaponTypeId] FOREIGN KEY ([WeaponTypeId]) REFERENCES [dbo].[WeaponTypes] ([Id])
    ALTER TABLE [dbo].[Schematics] ADD CONSTRAINT [FK_dbo.Schematics_dbo.Rarities_RarityId] FOREIGN KEY ([RarityId]) REFERENCES [dbo].[Rarities] ([Id])
    ALTER TABLE [dbo].[MaterialCosts] ADD CONSTRAINT [FK_dbo.MaterialCosts_dbo.Materials_MaterialId] FOREIGN KEY ([MaterialId]) REFERENCES [dbo].[Materials] ([Id])
    ALTER TABLE [dbo].[MaterialCosts] ADD CONSTRAINT [FK_dbo.MaterialCosts_dbo.Schematics_SchematicId] FOREIGN KEY ([SchematicId]) REFERENCES [dbo].[Schematics] ([Id])
    ALTER TABLE [dbo].[Materials] ADD CONSTRAINT [FK_dbo.Materials_dbo.Pictures_PictureId] FOREIGN KEY ([PictureId]) REFERENCES [dbo].[Pictures] ([Id])
    ALTER TABLE [dbo].[TraitImpacts] ADD CONSTRAINT [FK_dbo.TraitImpacts_dbo.Traits_TraitId] FOREIGN KEY ([TraitId]) REFERENCES [dbo].[Traits] ([Id])
    ALTER TABLE [dbo].[TraitImpacts] ADD CONSTRAINT [FK_dbo.TraitImpacts_dbo.Schematics_SchematicId] FOREIGN KEY ([SchematicId]) REFERENCES [dbo].[Schematics] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201808241555047_AutomaticMigration', N'Xolartek.ORM.Migrations.Configuration',  0x1F8B0800000000000400ED5DDB6EE4B8117D0F907F10FA290966DDF6CCCBC668EFC2DB1E2746C663C3EDD9EC9B41B7E8B630BA7424B5636FB05FB60FF9A4FC42A83B6FC58BA496DA9EC60003B74456158BA78A64912AFEEFF7FFCE7E7C0E7CE709C78917852793A383C38983C365E47AE1EA64B2491FBEFB7EF2E30F7FFCC3ECA31B3C3B3F57E53E64E548CD3039993CA6E9FA783A4D968F3840C941E02DE328891ED28365144C911B4DDF1F1EFE757A7434C584C484D0729CD9CD264CBD00E73FC8CF79142EF13ADD20FF3272B19F94CFC99B454ED5F98C029CACD1129F4C7E897C14A7F8EBC1D5CDE5C439F53D44645860FF61E2A0308C529412098FBF247891C651B85AACC903E4DFBEAC3129F780FC0497921F37C54D1B71F83E6BC4B4A958915A6E92340A2C091E7D28B532E5ABB7D2EDA4D61AD1DB47A2DFF4256B75AEBB93C9DF711C4D1C9ED1F1DC8FB342945AE7518C0FCEA3380DBD141F64D5DE39CCCB77350C085AB27FEF9CF9C64F37313E09F1268D91FFCEB9DEDCFBDEF21FF8E536FA8AC39370E3FBB4784440F28E79401E5DC7D11AC7E9CB0D7E2885BE7027CE94AD37E52BD6D5A83A45932EC2F4C3FB89F3993047F73EAE7B9F6AFE22250DFA1B0E718C52EC5EA334C57198D1C0B9FE04EE1CAFECFF8A1B811BB1998973899E3FE170953E126B3A245672EE3D63B77A524AF025F48889914A69BCC11209D55C17298A135D23D5243EE127EC772371869365ECAD0BB8822A207F1AA940CDEB06C5A437F43DABA672ED2D33940A6434ED24C898C738C347552F7B74EB05B29ED3636B1E05EB4D4E4CCD3763407A3A58575C7FF24214134866CE7213C7C44BBF5CE61ACCD5CB68FD7BB9CEFB94F6337AF2567955B99627CE0DF6F3F7C9A3B72E3C74EE4DEEEA02E77114DC447EE99CAAE7778B68132F33B38A242F6F51BCC2A9B9340572A4C214AFEE32F238A1A5615ED41C2B71D8B795B0B43CB369E37D953EB9D684A95B2E2BEC1D32E81A2BEC74F54796AE65BE58CC7D94245BF784A77EA610A29B9E391963B63228EB994451710F5D8857BFE3A90EBFA0C3ACDC617B87C9FB6FB93B3595A75800A4DE5229135D4A90AB7909C9469590C9676C1C359D16F651D7DD9B08C4ABA7E9F6EECC6BCF3631BAF7FCBCE9234FE77B58549CA100AD70371A73628FF347143683F8195E7A0122ADBB8EC95F6598824C70174B94516DC78215B57716A7698A965F6FA861BA77160D74AE71FC25D91EA38B608D9669B75E258E3B426EB164DA92989768857EF542BCF07EED08C11B147645F1691044F328E9AAB51157BDFFC4681D851F5D2FF383ADEA6615AC6507A70197C496628FD491CE02EAB1F38E2AD7CC0324AF859980AC8CED5C45B5F46DE84BD6BFC24B8578DB5B099B4EA28015B1649A652ADB6D8CBC54D7B5552199DA8A770AAD95056C95C69881543EA604A042A88CA049B0A0AD421B1354089DBD564ACC1500C4E54B750A8954C657784FEB49345D7D3F8F8678751F9A2A3D771D9C6AD8F43F5248815FBDBCA381C2205F5E42803E50CCD64EA905633FC31A2FA76AE8EB64A01D8C736F9810AF616340ED268A5AC32B4DAA4FEBE3C7758D91F6315FAB5948A66BFC3B583ED564CDD8E4F2B94BB50CB3B63AAAF6DEF0405ECC2277389B2B6650CCD641BB81B4E8E5DD1B8D4D073883C93D3CB471B37FAB558754AEFCCD1D65398C64E25B413649914EA36E296A3BE3DF9B3DC46B47F65C58A0F581477E405240B6151EB975B1352E99FA7B7CEE383E357B709D42203C52B5B1920E782DE2212DC19A15D923F52D20D53AEE25C728141D3301E86992444B2F178FDA77AFD71A6C6B3F86AEA33A275568BB3A5F45144E30E8AD09EA08E393C95F04ED01F4EA394C43AF5EFBB0240F0F0E8E04AA04AB38CEC092ADC6C284A0DF0B5311D85EB8F4D6C85708C0D53134874CD73575FECD195EE33043B2428F266CA925B2C8BD66C299A94E31B32985063548D8131850AF02C7319A6EADB602D85E15BB142229418A19F25A6144DA9C0140226DB309DF66DF6E1490005116A86B752197A68F9BD09F397074E154917A119CDE0A92D44D1D00526A6D98084007DEC745976EAC8283647A44A9C62C30B636E4B805093124865EE1F825DBD080FA59B969DF7435156032F74ACA9D93415D92A295036049A10713EE4CBC706440E9DC91E288850198540E093E9A31A44702A5181446AFD02749626B504FAB026D4D5797B15A736FA48A277364AB7D8AADF822B879036008568209F37AFB63642F546E63E85D057F60A9B7018DDF2C19124050F3067541AC025EC730064650A1FED687539B7EE762F5060390011F09BE2C06CF56E8D2B5790094E9D461228270B27644C4F19150350CC0B0288FB522CE6EEEBD34A70D878618D0CEC1F00528C21C5CD5D1EB31639406A8527C9ED543AC725C24816D1B2E70D90E4183062F8BCD1152272535705C8A90EFB19DA114DDA344B65FF725C1E5965D526E18F150C8A82E70CA7DD2D86CC530416B01486CED727D22AB5F2FEA3424729D7A521215BC3514E8DD2A810685650D19EEDC9D40890D7818125311D21261CF3408749839AB09299088B63A332ECBC870F32823723948415AC538C911A24C8585707312912A224BACC0DBAD66FFB096BCB114C1F4355B861489C65CF8ED6AB661068DE6BE37165BADD80E938D08DC8618257463A08A96CBF7C0B4DA6BD170E89CACA80193BD1E9BDD1EAA3594792B94A2D9DF91D02BDBD29F921466A1DEAC30DBAE68AF9261AC44FA9180A80A6DE8DD38F84E35831E96141A5185DBB78810C927772ABDE83102C790BBE8641898C88E108ADAD005434DC3A1541BAA6159A10B4500942754CBDE233A2A0955E09005F6CC427B5DA0C105F3B6A70CF8089FA814B360955DB88A6A193F0F53284A1B9D32D27D6B7509E7C8205D29C32C168116414BE5F452AB2228B4B22DFD483E2806676F467A8143052D67715B504675D6AF5ECED6EF66D38260F9603605F25DCE2ED17AED852B2AFF65F9C45914C92FE7DF2DEC734306058D29AB617EF15D734AA318AD30F736FB68D4C5E75E9CA4CDCA7CEE06423176F10EAC912A5ECCFA5CECB36AD15415CFFEA642046512D062192FC636CA5AE7A43541161CC94FB872D375B19A93E51C4584BAE430ED3CF2374108C768E0DA45E61ABA7EF1C49C42999F8526513E32A751A689A169948FCC6930077D694ACC0B737A4DBC89260647A1604AD446324D4AB1BFAC68259DF4916925FDC29C1E95CC91A6463D1669CDA61C8285789C60219CABE2EDCDC81AEB39676B7B0426D2062609D6DC8E555663086354D28FC854549ADC7F349DE6A939252AB91F4D8A7ABC3328A9C7DAD62829239FF620812A6E07236DFDDD48FDA29C4D19F64C134FB6EF1C45DD5D1D59FB1ED1E8A46E0C39EAF9B063761F73872A631A3B1816CF2C7C2595DE8DF196D4733B6A32B9E8E716DE974ADAC6B85FEA791B1454F9D9E458A8DE9A53AEB643189B916E91A8A8D029D9989917F5DC9C1A9B7D8DA6C7BEB19917867CB7968F2C7AB44EC3C6F467FDF4B5CF5285A3243445ED39131DDDEA148148143A5F30DAA8A7DBFD301CF898ED4FFBB14F5D7D3BC39F086F5B68D35F94B0860B7F69025363CED231038EEA90DDE8C0E901341D00B3EB73D93E7DD9481DADD9D230EC6BFA38827D772B6B6FA7C7FB992B30596AC4E1C07A9D5B9FD6666221D0116E98CE2B7336E01E920DFADAE26ED77DCC487DC2ED36B5EE1BF670907D1F69EAEFFB0AB37B5E1D3B2A3F79D5B697E495BFA12E1276BAF82235F77AC78BDBD99A95BB4CFAEBDE846DA7A24896383C7AF2DC6CCB69F192A43838C80A1C2CFEE5CF7D8FB4B729708942EF012769918065F2FEF0E83D776FDCEEDCE1364D12D797ECD251A96C808BDC2E42173F9F4CFEE3FC367C7A192F53B736818C6532BA228C5730089F50BC7C44B178DD43975B0E72B1BBDCB4D0868024514ED5BA3F05E8F9CF34C13657A3E532C1E8C82A1D3B17BFDC55F5DE395731319263E79020A773CA5053EE754588BDD1ED19E2CD6C2EF991E6B12BED7D66B60916F9EBD8E2E8DFE5B5995D99F5705FD89BB37EF64B10D0425A5DCED5C9DE840BB82CA875BF64EBCDF5B38D3BEC623AAA9B99DE9C526D87CE96D72275B223F1EAA35186E3CE1302F626A13614C42B8FDCED5F79D43B0BF1CAA3DE5940571EF5CE88CD06DDA64FC50B8F7A175276E1512B51E9EB8EDA10E02F3B6A27C4373B8B056E5A329581ABDE5D926A73AF8D18455D8BCEE8EB5E983737847735287AF7CEAE279B9A9D8C4A924BDE5402AAEA36A1F42DC0A8E3F47A5C5FD9D305196FAE53D9E949B7FE945C40D1C6DD70D74F9882A2ACF6461D0D7469C39B03E4508B78DDAD037BC576526C918E60AFD5965A6D99D3BD0EEACA128B5825EB2A768628325B4CCA0D7FE3D17B3A1BE0F32E91CFD899246DB2B377CC71346457831F6A8CD7D3AF33C37A6FC9D4E9C5E1D0B9D3874C710D9CC315F9A9CEAAEE5656F4FEBCBD15AA5E9FD7B7C2DBD89EBF555EF3EE595FC7F407AA8FC4C67708E3A77435CF4CDE9F4BB084D6EB730A76A01BDB2BD86616EF218B38778FE98079C307CB110E1EBF17D9BDB6ACE0DD4784F14030E878600B84F187836E19BE7BCBE73DCE08A13B1C3FF238F1BA3372F7907F7B4C540027F1770212D077AE3B9947BB6344691C0C0C175BB2EBFF1DC8822DE6DBE2BB4ECC720DE6B82E5A7F3271EFB3B06111DA06D2D5F274EBA58840BA7E23A30EA6AEE4E9575015C8572F64D4A1546F70E26C75DE6C190F4512389E0BBBDE1618B1AF65BCD4A94F2176CAC4DB2A367A16CC8451E0C2BC953152A6A794F282F37683F4F594B9A992C0817B2FE3A44E47A948FBADC9FA0DF32A3E70E3196D332D3867E24C2A2ED101F2BB1054256942FDD1137F8B49222519780668D60069BDA5F994958D95B92E319B458F8DEF275D775BC85A296AE7B271CB9394EE44FFF69E6CBB6D0F5B2A6B8752698B099E950D950CD1429A893EFBB5DF34D92DA03C4C83874C850D27BE1E19E20324B806D2598FDCF02D65AEB69D82F4D7508BACD4E237F96451BB09B3EF698B5F6738F1560D8919A119E225B39CADCB5C840F51B5AEE624AA8AF047D6718A5CB2D63D8D53EF81D83279BDC449E285AB89F333F237A4C8C7E01EBB17E1D5265D6F52D2641CDCFB8C22B3D5B98A7F9E7A9B957976959F044BFA680211D3CB3E41BE0A7FDA78BE5BCB7D2E39450690C896FDE559B7AC2FD3ECCCDBEAA5A6F4390A0D0995EAABA315B73858FB845872152ED0136E23DB97047FC22BB47CA9522BC044F41DC1AA7D76E6A1558C82A4A4D1D4273F0986DDE0F987FF030813CEB9AFB00000 , N'6.2.0-61023')
END
